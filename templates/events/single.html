{#
INDIVIDUAL EVENT TEMPLATE (templates/event.html)

Features:
- Hero section with event details
- Image gallery
- Projects showcase (for development events)
- Winners/Leaderboard podium
- Event content
#}

{% extends "index.html" %}

{% block header %}
{% endblock header %}

{% block content %}
{# ========== EVENT HERO ========== #}
<section class="event-hero">
    {# Background #}
    <div class="event-hero-bg {% if not page.extra.images %}no-image{% endif %}">
        {% if page.extra.images %}
        {% set first_image = page.extra.images | first %}
        <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ first_image) }}" alt="{{ page.title }}">
        {% endif %}
        <div class="event-hero-overlay"></div>
    </div>

    {# Content #}
    <div class="event-hero-content">
        {# Breadcrumb #}
        <nav class="event-breadcrumb">
            <a href="/events/">Events</a>
            <span class="breadcrumb-sep">/</span>
            <span>{{ page.title }}</span>
        </nav>

        {# Badges #}
        <div class="event-hero-badges">
            {% if page.extra.event_type %}
            <span class="event-type-badge {{ page.extra.event_type }}">{{ page.extra.event_type }}</span>
            {% endif %}
            {% if page.extra.status %}
            <span class="event-status-badge {{ page.extra.status }}">{{ page.extra.status }}</span>
            {% endif %}
            {% if page.extra.badge %}
            <span class="event-special-badge">{{ page.extra.badge }}</span>
            {% endif %}
        </div>

        {# Title #}
        <h1 class="event-hero-title">{{ page.title }}</h1>

        {# Description #}
        <p class="event-hero-desc">{{ page.description }}</p>

        {# Meta Grid #}
        <div class="event-hero-meta">
            <div class="event-meta-card">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <line x1="16" y1="2" x2="16" y2="6" />
                    <line x1="8" y1="2" x2="8" y2="6" />
                    <line x1="3" y1="10" x2="21" y2="10" />
                </svg>
                <div>
                    <span class="meta-label">Date</span>
                    {% if page.extra.date_label %}
                    <span class="meta-value">{{ page.extra.date_label }}</span>
                    {% else %}
                    <span class="meta-value">{{ page.date | date(format="%B %d, %Y") }}</span>
                    {% endif %}
                </div>
            </div>
            {% if page.extra.location %}
            <div class="event-meta-card">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                    <circle cx="12" cy="10" r="3" />
                </svg>
                <div>
                    <span class="meta-label">Location</span>
                    <span class="meta-value">{{ page.extra.location }}</span>
                </div>
            </div>
            {% endif %}
            {% if page.extra.participants %}
            <div class="event-meta-card">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
                <div>
                    <span class="meta-label">Participants</span>
                    <span class="meta-value">{{ page.extra.participants }}+</span>
                </div>
            </div>
            {% endif %}
            {% if page.extra.prize_pool %}
            <div class="event-meta-card">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" />
                    <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" />
                    <path d="M4 22h16" />
                    <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" />
                    <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" />
                    <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" />
                </svg>
                <div>
                    <span class="meta-label">Prize Pool</span>
                    <span class="meta-value">{{ page.extra.prize_pool }}</span>
                </div>
            </div>
            {% endif %}
        </div>

        {# Action Buttons #}
        <div class="event-hero-actions">
            {% if page.extra.external_link and page.extra.external_link != "#" %}
            <a href="{{ page.extra.external_link }}" target="_blank" rel="noopener" class="event-btn event-btn-primary">
                <span>Visit Official Site</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                    <polyline points="15 3 21 3 21 9" />
                    <line x1="10" y1="14" x2="21" y2="3" />
                </svg>
            </a>
            {% endif %}
            {% if page.extra.register_link %}
            <a href="{{ page.extra.register_link }}" target="_blank" rel="noopener" class="event-btn event-btn-accent">
                <span>Register Now</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="8.5" cy="7" r="4" />
                    <line x1="20" y1="8" x2="20" y2="14" />
                    <line x1="23" y1="11" x2="17" y2="11" />
                </svg>
            </a>
            {% endif %}
        </div>
    </div>
</section>

{# ========== IMAGE GALLERY ========== #}
{% if page.extra.images and page.extra.images | length > 1 %}
<section class="event-gallery">
    <h2 class="section-title">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
            <circle cx="8.5" cy="8.5" r="1.5" />
            <polyline points="21 15 16 10 5 21" />
        </svg>
        Gallery
    </h2>
    <div class="gallery-grid">
        {% for image in page.extra.images %}
        <div class="gallery-item" data-index="{{ loop.index0 }}">
            <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ image) }}"
                alt="{{ page.title }} - Image {{ loop.index }}" loading="lazy">
            <div class="gallery-item-overlay">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <circle cx="11" cy="11" r="8" />
                    <line x1="21" y1="21" x2="16.65" y2="16.65" />
                    <line x1="11" y1="8" x2="11" y2="14" />
                    <line x1="8" y1="11" x2="14" y2="11" />
                </svg>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}

{# ========== WINNERS / LEADERBOARD ========== #}
{# ========== WINNERS / LEADERBOARD ========== #}
{% if page.extra.winners %}
<section class="event-winners">
    <h2 class="section-title">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" />
            <path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" />
            <path d="M4 22h16" />
            <path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" />
            <path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" />
            <path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" />
        </svg>
        Winners
    </h2>

    {# Check for categories #}
    {% set first_winner = page.extra.winners | first %}
    {% if first_winner.category %}
    {# Grouped Winners Logic #}
    {% set grouped = page.extra.winners | group_by(attribute="category") %}

    {% for category, winners in grouped %}
    <div class="category-section">
        <h3 class="category-title">{{ category }}</h3>

        {# Podium #}
        <div class="winners-podium">
            {% for winner in winners %}
            {% if loop.index <= 3 %} <div class="podium-place place-{{ loop.index }}" data-place="{{ loop.index }}">
                <div class="podium-card">
                    <div class="podium-rank">
                        {% if loop.index == 1 %}
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5z" />
                            <path d="M19 19H5v2h14v-2z" />
                        </svg>
                        {% else %}
                        <span>{{ loop.index }}</span>
                        {% endif %}
                    </div>
                    {% if winner.avatar %}
                    <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ winner.avatar) }}"
                        alt="{{ winner.name }}" class="podium-avatar">
                    {% else %}
                    <div class="podium-avatar-placeholder">
                        {{ winner.name | truncate(length=2, end="") | upper }}
                    </div>
                    {% endif %}
                    <h3 class="podium-name">{{ winner.name }}</h3>

                    {# Project / Handle Logic #}
                    {% if winner.Codeforces_Id %}
                    <p class="podium-project font-mono text-sm">@{{ winner.Codeforces_Id }}</p>
                    {% elif winner.project %}
                    <p class="podium-project">{{ winner.project }}</p>
                    {% endif %}

                    {# Prize Logic #}
                    {% if winner.prize %}
                    <span class="podium-prize">{{ winner.prize }}</span>
                    {% endif %}
                </div>
                <div class="podium-stand"></div>
        </div>
        {% endif %}
        {% endfor %}
    </div>

    {# Honorable Mentions #}
    {% if winners | length > 3 %}
    <div class="winners-list">
        <div class="winners-list-grid">
            {% for winner in winners %}
            {% if loop.index > 3 %}
            <div class="winner-list-item">
                <span class="winner-rank">#{{ loop.index }}</span>
                {% if winner.avatar %}
                <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ winner.avatar) }}" alt="{{ winner.name }}"
                    class="winner-avatar">
                {% else %}
                <div class="winner-avatar-placeholder">{{ winner.name | truncate(length=2, end="") | upper }}</div>
                {% endif %}
                <div class="winner-info">
                    <span class="winner-name">{{ winner.name }}</span>

                    {% if winner.Codeforces_Id %}
                    <span class="winner-project font-mono">@{{ winner.Codeforces_Id }}</span>
                    {% elif winner.project %}
                    <span class="winner-project">{{ winner.project }}</span>
                    {% endif %}
                </div>

                {% if winner.prize %}
                <span class="winner-prize">{{ winner.prize }}</span>
                {% endif %}
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
    {% endif %}
    </div>
    {% endfor %}

    {% else %}
    {# Standard Winners Logic (Legacy) #}
    {# Podium #}
    <div class="winners-podium">
        {% for winner in page.extra.winners %}
        {% if loop.index <= 3 %} <div class="podium-place place-{{ loop.index }}" data-place="{{ loop.index }}">
            <div class="podium-card">
                <div class="podium-rank">
                    {% if loop.index == 1 %}
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M5 16L3 5l5.5 5L12 4l3.5 6L21 5l-2 11H5z" />
                        <path d="M19 19H5v2h14v-2z" />
                    </svg>
                    {% else %}
                    <span>{{ loop.index }}</span>
                    {% endif %}
                </div>
                {% if winner.avatar %}
                {% if winner.avatar is starting_with("http") %}
                <img src="{{ winner.avatar }}" alt="{{ winner.name }}" class="podium-avatar">
                {% else %}
                <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ winner.avatar) }}" alt="{{ winner.name }}"
                    class="podium-avatar">
                {% endif %}
                {% else %}
                <div class="podium-avatar-placeholder">
                    {{ winner.name | truncate(length=2, end="") | upper }}
                </div>
                {% endif %}
                <h3 class="podium-name">{{ winner.name }}</h3>

                {# Project / Handle Logic #}
                {% if winner.Codeforces_Id %}
                <p class="podium-project font-mono text-sm">@{{ winner.Codeforces_Id }}</p>
                {% elif winner.project %}
                <p class="podium-project">{{ winner.project }}</p>
                {% endif %}

                {# Prize Logic #}
                {% if winner.prize %}
                <span class="podium-prize">{{ winner.prize }}</span>
                {% endif %}
            </div>
            <div class="podium-stand"></div>
    </div>
    {% endif %}
    {% endfor %}
    </div>

    {# Other Winners (4th onwards) #}
    {% if page.extra.winners | length > 3 %}
    <div class="winners-list">
        <h3 class="winners-list-title">Honorable Mentions</h3>
        <div class="winners-list-grid">
            {% for winner in page.extra.winners %}
            {% if loop.index > 3 %}
            <div class="winner-list-item">
                <span class="winner-rank">#{{ loop.index }}</span>
                {% if winner.avatar %}
                {% if winner.avatar is starting_with("http") %}
                <img src="{{ winner.avatar }}" alt="{{ winner.name }}" class="winner-avatar">
                {% else %}
                <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ winner.avatar) }}" alt="{{ winner.name }}"
                    class="winner-avatar">
                {% endif %}
                {% else %}
                <div class="winner-avatar-placeholder">{{ winner.name | truncate(length=2, end="") | upper }}</div>
                {% endif %}
                <div class="winner-info">
                    <span class="winner-name">{{ winner.name }}</span>

                    {% if winner.Codeforces_Id %}
                    <span class="winner-project font-mono">@{{ winner.Codeforces_Id }}</span>
                    {% elif winner.project %}
                    <span class="winner-project">{{ winner.project }}</span>
                    {% endif %}
                </div>

                {% if winner.prize %}
                <span class="winner-prize">{{ winner.prize }}</span>
                {% endif %}
            </div>
            {% endif %}
            {% endfor %}
        </div>
    </div>
    {% endif %}
    {% endif %}
</section>
{% endif %}

{# ========== PROJECTS SHOWCASE ========== #}
{# ========== PROJECTS SHOWCASE ========== #}
{% if page.extra.projects %}
<section class="event-projects">
    <h2 class="section-title">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="16 18 22 12 16 6" />
            <polyline points="8 6 2 12 8 18" />
        </svg>
        Featured Projects
    </h2>

    {# Check for categories #}
    {% set first_project = page.extra.projects | first %}
    {% if first_project.category %}
    {# Grouped Projects Logic #}
    {% set grouped_projects = page.extra.projects | group_by(attribute="category") %}

    {% for category, projects in grouped_projects %}
    <div class="category-section">
        <h3 class="category-title">{{ category }}</h3>
        <div class="projects-grid">
            {% for project in projects %}
            <article class="project-card">
                {# Project Image #}
                {% if project.image %}
                <div class="project-card-image">
                    <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ project.image) }}"
                        alt="{{ project.name }}" loading="lazy">
                </div>
                {% endif %}

                {# Project Content #}
                <div class="project-card-content">
                    <h3 class="project-name">{{ project.name }}</h3>
                    {% if project.team %}
                    <p class="project-team">by {{ project.team }}</p>
                    {% endif %}
                    {% if project.description %}
                    <p class="project-desc">{{ project.description }}</p>
                    {% endif %}

                    {# Tech Stack #}
                    {% if project.tech %}
                    <div class="project-tech">
                        {% for tech in project.tech %}
                        <span class="tech-tag">{{ tech }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}

                    {# Project Links #}
                    <div class="project-links">
                        {% if project.demo %}
                        <a href="{{ project.demo }}" target="_blank" rel="noopener" class="project-link demo">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <polygon points="10 8 16 12 10 16 10 8" />
                            </svg>
                            Demo
                        </a>
                        {% endif %}
                        {% if project.github %}
                        <a href="{{ project.github }}" target="_blank" rel="noopener" class="project-link github">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                <path
                                    d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                            </svg>
                            GitHub
                        </a>
                        {% endif %}
                        {% if project.devfolio %}
                        <a href="{{ project.devfolio }}" target="_blank" rel="noopener" class="project-link devfolio">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                            </svg>
                            Devfolio
                        </a>
                        {% endif %}
                    </div>
                </div>

                {# Award badge #}
                {% if project.award %}
                <div class="project-award">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" />
                    </svg>
                    {{ project.award }}
                </div>
                {% endif %}
            </article>
            {% endfor %}
        </div>
    </div>
    {% endfor %}

    {% else %}
    {# Standard Projects Logic (Legacy) #}
    <div class="projects-grid">
        {% for project in page.extra.projects %}
        <article class="project-card">
            {# Project Image #}
            {% if project.image %}
            <div class="project-card-image">
                {% if project.image is starting_with("http") %}
                <img src="{{ project.image }}" alt="{{ project.name }}" loading="lazy">
                {% else %}
                <img src="{{ get_url(path=config.extra.image_base_url ~ '/' ~ project.image) }}"
                    alt="{{ project.name }}" loading="lazy">
                {% endif %}
            </div>
            {% endif %}

            {# Project Content #}
            <div class="project-card-content">
                <h3 class="project-name">{{ project.name }}</h3>
                {% if project.team %}
                <p class="project-team">by {{ project.team }}</p>
                {% endif %}
                {% if project.description %}
                <p class="project-desc">{{ project.description }}</p>
                {% endif %}

                {# Tech Stack #}
                {% if project.tech %}
                <div class="project-tech">
                    {% for tech in project.tech %}
                    <span class="tech-tag">{{ tech }}</span>
                    {% endfor %}
                </div>
                {% endif %}

                {# Project Links #}
                <div class="project-links">
                    {% if project.demo %}
                    <a href="{{ project.demo }}" target="_blank" rel="noopener" class="project-link demo">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <polygon points="10 8 16 12 10 16 10 8" />
                        </svg>
                        Demo
                    </a>
                    {% endif %}
                    {% if project.github %}
                    <a href="{{ project.github }}" target="_blank" rel="noopener" class="project-link github">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path
                                d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
                        </svg>
                        GitHub
                    </a>
                    {% endif %}
                    {% if project.devfolio %}
                    <a href="{{ project.devfolio }}" target="_blank" rel="noopener" class="project-link devfolio">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71" />
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71" />
                        </svg>
                        Devfolio
                    </a>
                    {% endif %}
                </div>
            </div>

            {# Award badge #}
            {% if project.award %}
            <div class="project-award">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z" />
                </svg>
                {{ project.award }}
            </div>
            {% endif %}
        </article>
        {% endfor %}
    </div>
    {% endif %}
</section>
{% endif %}

{# ========== EVENT CONTENT ========== #}
{% if page.content %}
<section class="event-content">
    <div class="prose">
        {{ page.content | safe }}
    </div>
</section>
{% endif %}

{# ========== BACK LINK ========== #}
<div class="event-back-link">
    <a href="/events/">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="19" y1="12" x2="5" y2="12" />
            <polyline points="12 19 5 12 12 5" />
        </svg>
        Back to All Events
    </a>
</div>

{# ========== IMAGE LIGHTBOX MODAL ========== #}
{% if page.extra.images and page.extra.images | length > 0 %}
<div id="gallery-lightbox" class="gallery-lightbox">
    <button class="lightbox-close" aria-label="Close lightbox">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18" />
            <line x1="6" y1="6" x2="18" y2="18" />
        </svg>
    </button>
    <button class="lightbox-nav lightbox-prev" aria-label="Previous image">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="15 18 9 12 15 6" />
        </svg>
    </button>
    <button class="lightbox-nav lightbox-next" aria-label="Next image">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 6 15 12 9 18" />
        </svg>
    </button>
    <div class="lightbox-content">
        <img id="lightbox-image" src="" alt="Gallery image">
    </div>
    <div class="lightbox-counter">
        <span id="lightbox-current">1</span> / <span id="lightbox-total">{{ page.extra.images | length }}</span>
    </div>
</div>

<script>
(function() {
    const lightbox = document.getElementById('gallery-lightbox');
    if (!lightbox) return;

    const lightboxImg = document.getElementById('lightbox-image');
    const lightboxCurrent = document.getElementById('lightbox-current');
    const closeBtn = lightbox.querySelector('.lightbox-close');
    const prevBtn = lightbox.querySelector('.lightbox-prev');
    const nextBtn = lightbox.querySelector('.lightbox-next');
    const galleryItems = document.querySelectorAll('.gallery-item');

    let currentIndex = 0;
    const images = [];

    // Collect all image sources
    galleryItems.forEach((item, index) => {
        const img = item.querySelector('img');
        if (img) {
            images.push(img.src);
            item.addEventListener('click', () => openLightbox(index));
        }
    });

    function openLightbox(index) {
        currentIndex = index;
        updateLightboxImage();
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeLightbox() {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
    }

    function updateLightboxImage() {
        lightboxImg.src = images[currentIndex];
        lightboxCurrent.textContent = currentIndex + 1;
    }

    function showNext() {
        currentIndex = (currentIndex + 1) % images.length;
        updateLightboxImage();
    }

    function showPrev() {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        updateLightboxImage();
    }

    // Event listeners
    closeBtn.addEventListener('click', closeLightbox);
    nextBtn.addEventListener('click', showNext);
    prevBtn.addEventListener('click', showPrev);

    // Close on background click
    lightbox.addEventListener('click', (e) => {
        if (e.target === lightbox || e.target.classList.contains('lightbox-content')) {
            closeLightbox();
        }
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
        if (!lightbox.classList.contains('active')) return;

        if (e.key === 'Escape') closeLightbox();
        if (e.key === 'ArrowRight') showNext();
        if (e.key === 'ArrowLeft') showPrev();
    });
})();
</script>
{% endif %}
{% endblock content %}